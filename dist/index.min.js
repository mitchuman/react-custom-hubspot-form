import{forwardRef as e,useState as a}from"react";import{jsxs as l,jsx as t,Fragment as n}from"react/jsx-runtime";const i=e((({label:e,value:a,className:n,...i},r)=>l("label",{htmlFor:i.name,className:n,"data-type":i.type||"text",children:[l("small",{children:[e,i.required&&t("span",{children:"*"})]}),t("input",{ref:r,id:i.name,placeholder:e,defaultValue:a,...i})]}))),r=e((({label:e,value:a,className:n,...i},r)=>l("label",{htmlFor:i.name,className:n,"data-type":i.type,children:[l("small",{children:[e,i.required&&t("span",{children:"*"})]}),t("textarea",{id:i.name,placeholder:e,defaultValue:a,...i})]}))),o=e((({label:e,options:a,value:n="",className:i,...r},o)=>l("label",{htmlFor:r.name,className:i,"data-type":r.type,children:[l("small",{children:[e,r.required&&t("span",{children:"*"})]}),l("select",{id:r.name,defaultValue:n,...r,children:[t("option",{value:"",disabled:!0,children:"Please select"}),a?.map(((e,a)=>t("option",{value:e,children:e},a)))]})]}))),d=e((({label:e,value:a,className:n,...i},r)=>l("label",{htmlFor:i.name,className:n,"data-type":i.type,children:[t("input",{id:i.name,defaultChecked:a,defaultValue:a,...i}),e]}))),c=e((({label:e,options:a,value:n,className:i,...r},o)=>l("div",{className:i,"data-type":r.type,children:[l("small",{children:[e,r.required&&t("span",{children:"*"})]}),a?.map(((e,a)=>l("label",{children:[t("input",{defaultChecked:n===e,defaultValue:n===e&&e,...r}),e]},a)))]})));function s({portalId:e,formId:s,fields:m,submitLabel:u="Submit",debug:p,apiKey:h}){const[f,b]=a(null),[y,g]=a(null);async function k(a){a.preventDefault();const l=Array.from(a.target.elements).filter((({name:e})=>!!e)).map((e=>({name:e.name,value:"checkbox"==e.type?String(e.checked):e.value}))),t=await async function({portalId:e,formId:a,fields:l}){const t=`https://api.hsforms.com/submissions/v3/integration/submit/${e}/${a}`,n="undefined"==typeof document||"undefined"==typeof location?{}:{hutk:document.cookie.match(/hubspotutk=([^;]+)/)?.[1],pageUri:location.href,pageName:document.title};return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fields:l,context:n})})}({portalId:e,formId:s,fields:l});b(t),g(t?.ok&&await t.json())}p&&function({formId:e,apiKey:a}){let l="";if(a){l=`${`https://api.hubapi.com/forms/v2/forms/${e}?hapikey=${a}`}\n\n(Look under \`formFieldGroups\`)`}else l="`apiKey` is undefined";console.debug(`%c useHubspotForm %cdebug: true\n\n${l}`,"background-color: #fff; color: #000;")}({formId:s,apiKey:h});const v=m.map((e=>{const a="radio"===e.type?c:"checkbox"===e.type?d:"select"===e.type?o:"textarea"===e.type?r:i;return({component:l=a,...n}={})=>t(l,{...e,...n})}));return{onSubmit:k,response:f,result:y,Fields:v,Form:({children:e,...a})=>f?.ok&&y?.redirectUri?(window.location.href=y.redirectUri,t("p",{children:"Redirecting..."})):f?.ok&&y?.inlineMessage?t("div",{dangerouslySetInnerHTML:{__html:y.inlineMessage}}):t("form",{onSubmit:k,...a,children:e||l(n,{children:[v?.map(((e,a)=>t(e,{},a))),t("button",{type:"submit",children:u})]})})}}export{s as useHubspotForm};
